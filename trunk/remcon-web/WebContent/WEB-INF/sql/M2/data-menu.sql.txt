SET @systemId = (SELECT cId FROM tOption WHERE cKey = 'SYSTEM');
SET @configId = (SELECT cId FROM tOption WHERE cKey = 'CONFIG');
SET @remuId = (SELECT cId FROM tOption WHERE cKey = 'REMU');
SET @reportId = (SELECT cId FROM tOption WHERE cKey = 'REPORT');

DROP PROCEDURE if exists pCreateData;

DELIMITER $$

CREATE PROCEDURE pCreateData()
BEGIN
	SELECT cId
	INTO @menuIdConta 
	FROM tOption 
	WHERE cKey = 'CONTA';
	
	IF(@menuIdConta IS NULL) THEN
		INSERT INTO tOption(cKey, cLabel, cUrl, cParent, cOrder) VALUES('CONTA', 'Contabilidad', NULL, NULL, 4);
		SET @menuIdConta = LAST_INSERT_ID();
	END IF;

	IF(NOT EXISTS(SELECT cId FROM tOption WHERE cKey = 'CHART_ACCOUNT')) THEN
		INSERT INTO tOption(cKey, cLabel, cUrl, cParent, cOrder) VALUES('CHART_ACCOUNT', 'Plan de cuentas', NULL, @menuIdConta, 1);
	END IF;
	
	IF(NOT EXISTS(SELECT cId FROM tOption WHERE cKey = 'VOUCHER')) THEN
		INSERT INTO tOption(cKey, cLabel, cUrl, cParent, cOrder) VALUES('VOUCHER', 'Comprobantes', NULL, @menuIdConta, 2);
	END IF;
	
	IF(NOT EXISTS(SELECT cId FROM tOption WHERE cKey = 'LEDGER')) THEN
		INSERT INTO tOption(cKey, cLabel, cUrl, cParent, cOrder) VALUES('LEDGER', 'Libro Mayor', NULL, @menuIdConta, 3);
	END IF;

	IF(NOT EXISTS(SELECT cId FROM tOption WHERE cKey = 'JOURNAL')) THEN
		INSERT INTO tOption(cKey, cLabel, cUrl, cParent, cOrder) VALUES('JOURNAL', 'Libro Diario', NULL, @menuIdConta, 4);
	END IF;

END$$

DELIMITER ;

CALL pCreateData();
DROP PROCEDURE pCreateData;

UPDATE tOption SET cOrder = 1 WHERE cId = @systemId;
UPDATE tOption SET cOrder = 2 WHERE cId = @configId;
UPDATE tOption SET cOrder = 3 WHERE cId = @remuId;
UPDATE tOption SET cOrder = 5 WHERE cId = @reportId;


